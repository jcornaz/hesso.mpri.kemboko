function [y1] = ann_predict(x1)
% gesture recognition.
%
% Generated by Neural Network Toolbox function genFunction, 30-May-2015 08:54:40.
%
% [y1] = ann_predict(x1) takes these arguments:
%   x = Qx12 matrix, input #1
% and returns:
%   y = Qx1 matrix, output #1
% where Q is the number of samples.

%#ok<*RPMT0>

x1 = x1';

% ===== NEURAL NETWORK CONSTANTS =====

% Input 1
x1_step1_xoffset = [0.343787217653925;0.414013123296145;0.672978135532321;0.0822002592600578;0.0967923555119775;0.0668793059750423;0.465899430552974;0.304871683118527;0.629426434694398;0.0717384528106845;0.124688378708049;0.0928043803434493];
x1_step1_gain = [0.0396297302486842;0.0577547565383971;0.0447337584531044;0.136072258799013;0.043698946179091;0.1394472833171;0.0174552527050572;0.0182318595397165;0.0351926210029457;0.0468967668378279;0.035792194106288;0.0420676070740895];
x1_step1_ymin = -1;

% Layer 1
b1 = [-1.2897809698769664433;-1.9698234673691641383;2.6705870884133258158;0.8206459258679850155;-0.01120938200681046229;0.32418934517053243916;-1.6376899192807055083;-0.31760261570753128835;0.11647545791515089009;1.1609323198218477469;-0.43230925713845591574;-0.88519234409669533825;-2.1061358530166831571;-1.3010024666495956236;2.4752380289309616757;-0.83972470066006621447;1.4925663315966459788;-1.8798971958631394141;1.5917728294985336035;-1.8070379832757883509];
IW1_1 = [0.59904368307850985875 0.048533519619565923531 -0.28286275412407158036 -0.92906401680309114166 -1.0907684211438308797 -0.69609213651647516841 -0.47132704994811280841 0.28481057092238687423 0.41923799704114023124 -1.3477718011177559632 0.74597456631366476643 1.2759140126980932362;1.0748739474346873379 1.484779959089280954 0.67696771903468722087 0.89906542747564210938 -0.50778435411301492408 -0.93307142818083277369 0.10979607294453802568 -1.7765240018022878665 -1.4995242524460363764 -0.94163590679152409102 -0.6643330894892632843 -0.30528414737115078248;0.00088115672518347676334 0.21801815221937376199 0.53002266774794193349 -0.42998282490527806043 0.41677539450760731077 0.54726345883535698622 0.4155053492126817849 0.88474448254555704274 -0.32846810532062054033 -0.27718678943711572149 2.8159631060706260541 -0.6508685557338954597;-1.3395740276476755248 0.16929236441635800436 -1.5333036182976544914 0.44940880484015799379 1.7318622348275023448 0.58641727680093047592 -0.75483024484958893829 -1.9036447989433640249 2.2602023976863394594 1.0721513542251150941 0.52177204889465822468 0.38691258945484280352;0.56745399781698879771 0.44080773467540457222 0.55985394345253203241 -0.28944052372502038217 -0.5992805038916131366 -0.11832503639417644992 1.8828956722137026869 -1.5339269373944233177 0.80901030605668888818 -0.15691325013458856663 -1.4572925188062806345 -1.1960789188043829956;1.5301500050834886402 0.45305559746125417808 1.1173543712471374345 1.3196579685658922365 -1.2296222730545736113 -0.82771676815549433126 1.8107529493140899213 1.3040665042470380719 -1.9472613252684529694 -1.5954733844358988115 -1.4594829519273024854 0.48993223315921624605;0.57518871425217843463 0.15132767341280167761 -0.12722781922492312767 0.25877677757032235828 -1.3408103396952757436 -0.71179105906593598263 0.045763125105967188133 1.2969349748841876302 -0.6388059177572359415 -1.4798210953509589594 -1.9567801943119582653 0.34313923358739378822;1.211940251204960628 -0.033941451685345583322 -0.23060989034271886511 1.6606920556447997139 0.061852762035955896613 0.38598501273646090848 0.14581547386843823899 -2.039813969911279834 -0.61285984040201069156 -0.68772531889235966052 0.057403030431382298659 0.335426818027212581;-0.016582736470093353831 0.28103883310547705943 0.25799913061779816692 -0.43242945297422996642 -1.5435973420052637728 0.043569936953051835449 -0.64789980581852346653 1.3475872742477152944 -1.3442169014231788449 -0.10712154776900054132 3.1206614796970066905 -2.1101450728751007802;2.1628477625760167413 0.38401821633424770841 -0.72529625081270487907 0.32822797716169110904 0.19879494095494590344 -2.1550059812775952395 -0.22747901389510383208 2.3027659025262479098 -1.3190787439220414967 -1.0655869322562472323 0.18336399417321475047 1.7331924594992775823;0.63610769487760776553 1.1573154562404885937 -0.69676517173741769895 -1.9016009426546838235 -0.19636942376770671892 0.25876066071166936577 1.913160537471417566 0.14038714602984972424 -0.84057929821207155729 -1.1841047929792591908 -0.80627599862884780091 0.93452944130527693112;-0.48257865933649901624 -0.65520416408741166681 -0.20581013806388659404 0.40998653829381909164 0.33727940794780048028 0.22285507908489071704 -0.68290282287498071945 1.1171758646172791352 -1.2398547960422252601 1.8767241429195156144 -3.0890952675812486383 1.9165887093776203809;-2.0381752855312922357 0.71396111921845284431 0.12901959023171763463 -0.97123624108878048311 -0.14239849103463586566 -0.69630629414815514711 -1.6035374258995278574 -0.87535849351688910236 1.6667679760221902896 -0.38865436152948162896 -0.15063732573442401019 1.4116144260582161873;-0.99325535266160769332 0.5401433179999297618 -1.0515156486036050243 0.39995036135521339071 -0.56721676626945383148 -0.13230689374823453863 -0.30281497220894371125 -1.1532886915654219084 0.10047519194028642353 -1.7095906662049604741 1.1579422323019279428 2.1932153076381597501;0.094333701028508104569 -0.98726378443370588212 -1.6634054887887412821 -0.17195099208545144842 2.2256139167383994781 -0.2076564265023022049 0.030634666157877920439 1.3799806944790069529 0.59952419846386506563 0.35420403206864592427 -0.88584149582579485571 3.195429049106737196;0.67731464199128688097 -2.3345364526478600276 -0.018618110813420619271 0.52662004834584164037 -0.73651419115836891383 1.5927594623746557101 -0.043141135457156323807 1.5359569812675240019 -1.8601706774826374247 0.54274405870264041951 0.63508579521374619592 -0.64164474459981890586;0.24987068702377376872 0.21558939657646727928 -0.93610908775537360338 -0.74595022762109541858 -0.0093247232295461997958 -0.15947523547941852562 0.26864020643408498268 0.64005159741726624922 -0.6492683047216947223 -0.16504383989086390816 -0.54579455351454253531 0.23120347904627769342;-0.26423127999993401005 0.25661363021447436417 -0.016745200896236774046 -0.016268629035991924447 -0.40053654795257620513 -0.44254609891787899389 0.28167685983842677411 0.9315839199433233464 0.13188873517441426775 0.31575490096681291252 1.0441056480517834082 -0.3472027886614808545;0.38042070028808200322 -0.27520561888619143875 -0.62335486219467839408 -0.69207262226245735981 0.53259815045797265221 0.3994283943671419479 0.070782614842831895197 0.22135353079913278052 -0.34365591200773548675 -0.7363858939031344697 -0.70182728979740027775 -0.72694845926255158286;-0.43006715624759317418 0.57568021181437734057 0.54723982538919868635 0.77687794049708636113 0.23089433069300074886 -0.21084049049514361207 -0.37002293246444056818 -0.19038781382569072709 0.76581014701182914539 -0.41986656109434988826 0.75702766870475346472 0.45321668518547808535];

% Layer 2
b2 = [0.27484726600092129756;-0.15146806052077127491;-0.017608729917507063428;-0.82326346444742137809;0.77333370093845377191;0.46556816841049242228;-0.034213264111983165972;0.026938792330299030781;-0.16856059806669940193;0.4774328351571018314;0.20116081721682724237];
LW2_1 = [0.48441105516734278558 0.74796471549729903749 -1.1674436303862341102 -2.0968031841266854265 0.7080189368940393857 0.27524517010118348948 1.4184495691928755701 -1.7739733277845339821 0.74222231072646083216 0.77229233901023031095 1.2206160939039116808 -0.47632117754964664602 1.0848913437923957126 -0.91329821775396535788 -2.1239704543067192688 -1.5098078492290225583 -0.41231031822048519464 1.1768090462349956038 -0.12872559496128119227 0.75527681509169719565;-0.035844287144925900124 -0.88893671569026677659 -1.6156835629009578259 0.27091028171049624795 -1.5014666620345429315 -0.28662780256948128255 1.708122604179944215 -0.41658005498825384505 -0.13743395086284196371 2.3510615201732747437 -2.0517585793293942054 3.0193892064857257296 1.5089221935876615532 0.42711423264346098927 2.2288756217065719412 -0.088472884641927984628 -0.49900306842011699082 -0.81163214816394690931 0.65515623567711434028 0.21758400679782721743;0.14912893921655800966 0.90805075617628705498 -1.5604243040860084069 2.0743272432611936651 1.1617706994069088022 -0.82674625725825356959 0.005294134591382265026 1.1580233020454973047 -2.5619087925592118893 0.1286749918142590654 0.34129164465970185383 0.47757507364282431039 1.0647580133858263185 1.618254618673071743 2.4900267913978706424 -1.1186350683415842155 -0.15042079931559274031 0.11070036958883476552 0.62900356157802927992 -0.63674401280439418827;0.23289595665441195638 1.2161200478075202547 1.0587889901331246634 -2.9578506897139380527 0.45378382961515623117 2.1752857187658589666 1.2108230665554304828 1.280709364040492515 1.2837940070074584931 0.44826532678383423924 -0.37906597381283801962 -0.4091841305569863807 -1.9093863551731555805 -0.28379779241767050246 -2.0800864836379924228 2.2619996142693472585 0.43086676663718970204 -0.56120485872379100023 0.8536958787295635398 0.34760746117529073285;-0.0016273382077519552708 2.7671888811259650609 -0.34116530314537346635 -0.90862433210405890716 0.55585954584357566421 1.6654719637124251186 1.0299698141979996002 1.2786732775317497524 -1.1685981697384366651 -1.0619809464282305989 -0.46957463170441271494 0.48906647912127443334 -0.97864955358256211504 0.8264896641329360083 -2.4046502764757060611 -0.62292130228174591444 -0.35857600924630750328 -0.47143996235233159853 -0.70789708565736331192 -0.030619432236598822378;1.4220265017516400263 -0.50218523874421616693 1.0452750149220668696 -0.074917338644195807795 -0.53724291943767854551 -0.93062550507578467585 -0.048964420413682638311 0.43141513319084912048 0.59992011644288267824 1.6697392419844947486 -0.930894793672446208 -3.5363786756757482621 0.98220073189066536834 1.9304295182461270741 -0.30868074787416560634 -0.89029312596558807247 -0.48559597346708155419 -0.68926991301409201718 0.58164632671610028147 0.52789181468547807796;0.20822432323624689987 -1.2206216518195172061 0.88148724155868329877 0.95899415731765391691 -0.32942529091422256826 -1.0793099404479959968 -0.88325832331813802778 -1.2805034516636264463 0.83505957271763298078 -2.4939024461638306107 -1.2458854943853334696 -1.3353635362401383713 2.5855903839218021822 0.73105473262982245686 -1.5340729890917768063 -1.2225352514387779479 -0.28717869841351545412 0.3939367857001053741 -0.51038869581082968452 0.65178992334292795707;0.16099540408882584419 -1.1825069842005913046 -0.81696100906982416223 0.70821997015660909103 0.94670220806205651609 -2.0777148910760687706 -0.27335616565791998056 0.22264672164640653129 -2.5286650880941352604 -2.4188660006232987065 -0.78411495940689168727 1.6889135330038702598 -1.2553541189957582169 -0.99430551936745770192 -0.59933933826101104536 2.1496745875984144547 -0.44660502419556769027 0.3422112976019916486 -0.98144190762588046084 -0.26969596242729321212;-0.44423005412527283298 -0.90462086954969644914 2.3138668224662750639 1.0981182698632063754 -1.7209351202012657112 -1.1158913439484623442 -2.3072736594956029244 0.86099603313103523217 1.6942379550778261521 -1.6558450429307820517 -0.32631421201729549075 -0.10544619355003923 -1.2354183297551504239 1.671755086020164871 -0.44312700660290721411 1.2705807662195092167 -0.78221177597406188475 0.37431580513242462827 -0.06245798851570929372 0.49469440536278436182;-1.0159235279197598167 -1.6123239609461441635 1.7719973595866507221 0.10367275019279326154 -0.37247752501431369287 0.24974182487953830445 -1.6891695437232774335 -1.4972308094287307689 -0.29543453174751649337 1.495256921692244223 -0.5189684584636234943 -0.75588275046550945646 -2.0085135089769439176 -3.2965672361293361092 2.1079999010254883984 -1.0933310091435037847 0.59048102290316117902 -0.24076611052063087715 0.02575211437613216664 0.023423792306395747886;1.1663820506125930354 -1.9183186186455829514 0.88401711547426975457 -1.0021604678206297301 -1.1696094147649951367 2.6958910202389989585 1.3867154728741049041 -0.60496629946026725388 -0.90728562150859948243 2.8288603845426671946 1.9231198375768174813 0.62405668478303988334 -0.89247604240861355684 0.39274342883337676202 2.6977753938243149712 0.13951090960405443386 -0.29445603422306093622 0.1675335300194485677 0.040868733729004014243 -0.024503469415049505126];

% ===== SIMULATION ========

% Dimensions
Q = size(x1,2); % samples

% Input 1
xp1 = mapminmax_apply(x1,x1_step1_gain,x1_step1_xoffset,x1_step1_ymin);

% Layer 1
a1 = tansig_apply(repmat(b1,1,Q) + IW1_1*xp1);

% Layer 2
a2 = softmax_apply(repmat(b2,1,Q) + LW2_1*a1);

% Output 1
y1 = to_labelid_vector(a2');
end

% ===== MODULE FUNCTIONS ========

% Map Minimum and Maximum Input Processing Function
function y = mapminmax_apply(x,settings_gain,settings_xoffset,settings_ymin)
y = bsxfun(@minus,x,settings_xoffset);
y = bsxfun(@times,y,settings_gain);
y = bsxfun(@plus,y,settings_ymin);
end

% Competitive Soft Transfer Function
function a = softmax_apply(n)
nmax = max(n,[],1);
n = bsxfun(@minus,n,nmax);
numer = exp(n);
denom = sum(numer,1);
denom(denom == 0) = 1;
a = bsxfun(@rdivide,numer,denom);
end

% Sigmoid Symmetric Transfer Function
function a = tansig_apply(n)
a = 2 ./ (1 + exp(-2*n)) - 1;
end
